{"version":3,"sources":["ffcp.min.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_forceStyle","image","container","containerStyle","window","getComputedStyle","imageStyle","position","style","overflow","_getImageParameters","options","params","containerWidth","dataset","width","getAttribute","offsetWidth","containerHeight","heigh","offsetHeight","imageWidth","imageHeight","height","scale","rounding","align","x","alignX","y","alignY","_applyLayout","targetImageStyle","layout","top","left","maxWidth","margin","_roundLayoutDimensions","Math","_parse","target","containerSelector","imageSelector","containers","querySelectorAll","pairs","forEach","i","querySelector","push","console","warn","_waitTillContentReady","Promise","resolve","onload","_show","src","_srcChanged","tmpImage","document","createElement","cache","Resizer","resize","_hide","element","display","_calculateLayout","fit","source","dest","scaleX","undefined","scaleY","scaleFactor","result","FITS","FILL","BEST_FIT_DOWN_ONLY","BEST_FIT","NONE","BEST_FILL","round","ALIGNS","LEFT","RIGHT","MIDDLE","CENTER","TOP","BOTTOM","DEFAULT_OPTIONS","forceStyle","autoResize","selectors","errors","HTMLElement","length","err","then","Object","assign","parameters","indexOf","resizeAll","opts","pair"],"mappings":"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","file":"ffcp.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ffcp\"] = factory();\n\telse\n\t\troot[\"ffcp\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tmodule.exports = function () {\n\t  'use strict';\n\t\n\t  var Resizer = {};\n\t\n\t  var ALIGNS = {\n\t    LEFT: 'left',\n\t    RIGHT: 'right',\n\t    CENTER: 'center',\n\t    MIDDLE: 'middle',\n\t    TOP: 'top',\n\t    BOTTOM: 'bottom'\n\t  };\n\t\n\t  var FITS = {\n\t    NONE: 'none',\n\t    FILL: 'fill',\n\t    BEST_FILL: 'best-fill',\n\t    BEST_FIT: 'best-fit',\n\t    BEST_FIT_DOWN_ONLY: 'best-fit-down'\n\t  };\n\t\n\t  var DEFAULT_OPTIONS = {\n\t    scale: FITS.BEST_FILL,\n\t    alignX: ALIGNS.CENTER,\n\t    alignY: ALIGNS.CENTER,\n\t    forceStyle: true,\n\t    //target     : document.body,\n\t    autoResize: true,\n\t    rounding: 'ceil',\n\t    selectors: {\n\t      container: '.ffcp-container',\n\t      image: '.ffcp-image'\n\t    }\n\t  };\n\t\n\t  Resizer.resize = function (container, image, options) {\n\t    var errors = [];\n\t\n\t    if (!(container instanceof HTMLElement)) errors.push('wrong container parameter');\n\t    if (!(image instanceof HTMLElement)) errors.push('wrong image parameter');\n\t    if (errors.length) {\n\t      errors.forEach(function (err) {\n\t        return console.warn(err);\n\t      });\n\t      return;\n\t    }\n\t    _waitTillContentReady(image).then(function () {\n\t      if (image.cache) {\n\t        if (image.cache.src === image.src) {\n\t          Object.assign(image, image.cache);\n\t        } else {\n\t          _srcChanged(image, container, options);\n\t          return;\n\t        }\n\t      } else image.cache = {\n\t        width: image.width,\n\t        height: image.height,\n\t        src: image.src\n\t      };\n\t      var parameters = _getImageParameters(image, container, options || {});\n\t\n\t      if (!!options.forceStyle) _forceStyle(image, container);\n\t      var dest = {};\n\t      dest.width = parameters.containerWidth;\n\t      dest.height = parameters.containerHeight;\n\t      var source = {};\n\t      source.width = parameters.imageWidth;\n\t      source.height = parameters.imageHeight;\n\t\n\t      var layout = _calculateLayout(parameters.scale, parameters.align, source, dest);\n\t\n\t      if (['ceil', 'floor', 'round'].indexOf(parameters.rounding) !== -1) {\n\t        _roundLayoutDimensions(layout, parameters.rounding);\n\t      }\n\t      _applyLayout(image.style, layout);\n\t      _show(image);\n\t    });\n\t  };\n\t\n\t  Resizer.resizeAll = function (target, options) {\n\t    if (!(target instanceof HTMLElement)) {\n\t      console.warn('wrong target parameter');\n\t      return;\n\t    }\n\t\n\t    var opts = Object.assign({}, DEFAULT_OPTIONS, options),\n\t        pairs = _parse(target, opts.selectors.container, opts.selectors.image);\n\t    pairs.forEach(function (pair) {\n\t      return Resizer.resize(pair.container, pair.image, opts);\n\t    });\n\t  };\n\t\n\t  function _forceStyle(image, container) {\n\t    var containerStyle = window.getComputedStyle(container),\n\t        imageStyle = window.getComputedStyle(image);\n\t\n\t    if (containerStyle.position !== 'fixed' && containerStyle.position !== 'relative' && containerStyle.position !== 'absolute') {\n\t      container.style.position = 'relative';\n\t    }\n\t    if (imageStyle.position !== 'fixed' && imageStyle.position !== 'relative' && imageStyle.position !== 'absolute') {\n\t      image.style.position = 'absolute';\n\t    }\n\t    if (containerStyle.overflow !== 'hidden') container.style.overflow = 'hidden';\n\t  }\n\t\n\t  function _getImageParameters(image, container, options) {\n\t    var params = {};\n\t    params.containerWidth = options.containerWidth || container.dataset.width || container.getAttribute('width') || container.offsetWidth;\n\t    params.containerHeight = options.containerHeight || container.dataset.heigh || container.getAttribute('height') || container.offsetHeight;\n\t    params.imageWidth = options.imageWidth || image.dataset.width || image.getAttribute('width') || image.offsetWidth;\n\t    params.imageHeight = options.imageHeight || image.dataset.height || image.getAttribute('height') || image.offsetHeight;\n\t    params.scale = options.scale || image.dataset.scale;\n\t    params.rounding = options.rounding || image.dataset.rounding;\n\t    params.align = {\n\t      x: options.alignX || image.dataset['align-x'],\n\t      y: options.alignY || image.dataset['align-y']\n\t    };\n\t    return params;\n\t  }\n\t\n\t  function _applyLayout(targetImageStyle, layout) {\n\t    targetImageStyle.position = 'relative';\n\t    targetImageStyle.top = layout.y + 'px';\n\t    targetImageStyle.left = layout.x + 'px';\n\t    targetImageStyle.width = layout.width + 'px';\n\t    targetImageStyle.height = layout.height + 'px';\n\t    targetImageStyle.maxWidth = 'none';\n\t    targetImageStyle.margin = 0;\n\t  }\n\t\n\t  function _roundLayoutDimensions(layout, rounding) {\n\t    layout.width = Math[rounding](layout.width);\n\t    layout.height = Math[rounding](layout.height);\n\t    layout.x = Math[rounding](layout.x);\n\t    layout.y = Math[rounding](layout.y);\n\t  }\n\t\n\t  function _parse(target, containerSelector, imageSelector) {\n\t    var containers = target.querySelectorAll(containerSelector),\n\t        pairs = [];[].forEach.call(containers, function (container, i) {\n\t      var image = container.querySelector(imageSelector);\n\t      if (image) {\n\t        pairs.push({ container: container, image: image });\n\t      } else {\n\t        console.warn('Failed to find an image in your container.');\n\t      }\n\t    });\n\t\n\t    return pairs;\n\t  }\n\t\n\t  function _waitTillContentReady(image) {\n\t    return new Promise(function (resolve) {\n\t      image.onload = function () {\n\t        resolve();\n\t        _show(image);\n\t        image.onload = null;\n\t      };\n\t      image.src = image.src;\n\t    });\n\t  }\n\t\n\t  function _srcChanged(image, container, options) {\n\t    var tmpImage = document.createElement('img'); // in-memory image for getting real image size\n\t    tmpImage.onload = function () {\n\t      image.cache.src = tmpImage.src;\n\t      image.cache.width = tmpImage.width;\n\t      image.cache.height = tmpImage.height;\n\t      Resizer.resize(container, image, options); // resize again after new image is loaded. May be not the best solution\n\t      _show(image);\n\t    };\n\t    tmpImage.src = image.src;\n\t    _hide(image);\n\t  }\n\t\n\t  function _hide(element) {\n\t    element.style.display = 'none';\n\t  }\n\t\n\t  function _show(element) {\n\t    element.style.display = 'block';\n\t  }\n\t\n\t  function _calculateLayout(fit, align, source, dest) {\n\t    var scaleX = undefined,\n\t        scaleY = undefined,\n\t        scaleFactor = undefined;\n\t\n\t    var result = { x: 0, y: 0, width: dest.width, height: dest.height };\n\t    if (fit === FITS.FILL) return result;\n\t\n\t    scaleX = dest.width / source.width;\n\t    scaleY = dest.height / source.height;\n\t\n\t    switch (fit) {\n\t      case FITS.BEST_FIT_DOWN_ONLY:\n\t        if (source.width > dest.width || source.height > dest.height) {\n\t          scaleFactor = scaleX < scaleY ? scaleX : scaleY;\n\t        } else {\n\t          scaleFactor = 1.0;\n\t        }\n\t        break;\n\t      case FITS.BEST_FIT:\n\t        scaleFactor = scaleX < scaleY ? scaleX : scaleY;\n\t        break;\n\t      case FITS.NONE:\n\t        scaleFactor = 1.0;\n\t        break;\n\t      case FITS.BEST_FILL:\n\t      default:\n\t        scaleFactor = scaleX > scaleY ? scaleX : scaleY;\n\t        break;\n\t    }\n\t\n\t    result.width = Math.round(source.width * scaleFactor);\n\t    result.height = Math.round(source.height * scaleFactor);\n\t\n\t    switch (align.x) {\n\t      case ALIGNS.LEFT:\n\t        result.x = 0;\n\t        break;\n\t      case ALIGNS.RIGHT:\n\t        result.x = dest.width - result.width;\n\t        break;\n\t      case ALIGNS.MIDDLE:\n\t      case ALIGNS.CENTER:\n\t        result.x = (dest.width - result.width) / 2;\n\t        break;\n\t    }\n\t\n\t    switch (align.y) {\n\t      case ALIGNS.TOP:\n\t        result.y = 0;\n\t        break;\n\t      case ALIGNS.BOTTOM:\n\t        result.y = dest.height - result.height;\n\t        break;\n\t      case ALIGNS.MIDDLE:\n\t      case ALIGNS.CENTER:\n\t        result.y = (dest.height - result.height) / 2;\n\t        break;\n\t    }\n\t\n\t    return result;\n\t  }\n\t\n\t  Resizer.ALIGNS = ALIGNS;\n\t  Resizer.FITS = FITS;\n\t\n\t  return Resizer;\n\t}();\n\n/***/ }\n/******/ ])\n});\n;\n//# sourceMappingURL=ffcp.js.map"],"sourceRoot":"/source/"}